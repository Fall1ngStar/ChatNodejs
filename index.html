em<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Chat nodejs</title> 
  </head>
  <body>
    <h1>Mon chat</h1>
    <input type="text" placeholder="Type here ..." id="msg" onKeyPress="if(event.keyCode == 13) sendMessage()">
    <input type="button" value="envoyer le message" onClick="sendMessage()"/>

    <div id="messages">

    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io.connect('http://localhost:8080');

      var user = prompt("Entrer votre nom d'utilisateur");

      
      socket.on('message', function(message){
      console.log("Reception d'un message");
      var histo = document.getElementById("messages");
      histo.innerHTML = "<p>"+message['date']+" <strong>"+message['user']+"</strong> : "+message["message"] +"</p>" + histo.innerHTML;
      });

      
      
      var pokeServer = function()
      {
      socket.emit("message", "poke");
      }

      var sendMessage = function()
      {
      var text = document.getElementById("msg").value;
      var now = new Date();
      var timestamp = '[' + now.getHours() + ':' + now.getMinutes() + ']';
      socket.emit("message", {"user": user, "message": text, "date": timestamp});
      var histo = document.getElementById("messages");
      histo.innerHTML = "<p>"+timestamp+" <strong>"+user+"</strong> : "+text+"</p>" + histo.innerHTML;
      document.getElementById("msg").value = '';
      }
    </script>
  </body>
</html>
